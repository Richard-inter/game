syntax = "proto3";

package clawMachine;

option go_package = "github.com/Richard-inter/game/pkg/protocol/clawMachine";

import "player/player.proto";

message Item {
    int64 itemID = 1;
    string name = 2;
    string rarity = 3;
    int64 spawnPercentage = 4;
    int64 catchPercentage = 5;
    int64 maxItemSpawned = 6;
}

message ClawMachine {
    int64 machineID = 1;
    string name = 2;
    repeated Item items = 3;
    int64 price = 4;
    int32 maxItem = 5;
}   

message ClawPlayer {
    player.Player basePlayer = 1;

    // game specific attributes
    int64 coin = 2;
    int64 diamond = 3;
}

message Items {
    int64 itemID =1;
}

message CreateClawMachineReq {
    string name = 1;
    repeated Items items = 2;
    int64 price = 3;
    int32 maxItem = 4;
}

message CreateClawMachineResp {
    ClawMachine machine = 1;
}

message StartClawGameReq {
    int64 playerID = 1;
    int64 machineID = 2;
}

message ClawResult {
    int64 itemID = 1;
    optional bool catched = 2;
}

message StartClawGameResp {
    int64 gameID = 1;
    repeated ClawResult results = 2;
}

message GetClawPlayerInfoReq {
    int64 playerID = 1;
}

message GetClawPlayerInfoResp {
    ClawPlayer player = 1;
}

message GetClawMachineInfoReq {
    int64 machineID = 1;
}

message GetClawMachineInfoResp {
    ClawMachine machine = 1;
}

message CreateItemReq {
    string name = 1;
    string rarity = 2;
    int64 spawnPercentage = 3;
    int64 catchPercentage = 4;
    int64 maxItemSpawned = 5;
}

message CreateClawItemsReq {
    repeated CreateItemReq clawItems = 1;
}

message CreateClawItemsResp {
    repeated Item clawItems = 2;
}

message CreateClawPlayerReq {
    ClawPlayer player = 1;
}

message CreateClawPlayerResp {
    ClawPlayer player = 2;
}

message AdjustPlayerCoinReq{
    int64 playerID = 1;
    int64 amount = 2;
    string type = 3;
}

message AdjustPlayerCoinResp{
    int64 playerID = 1;
    int64 adjustedAmount = 2;
}

message AdjustPlayerDiamondReq{
    int64 playerID = 1;
    int64 amount = 2;
    string type = 3;
}

message AdjustPlayerDiamondResp{
    int64 playerID = 1;
    int64 adjustedAmount = 2;
}

service ClawMachineService {
    // player
    rpc CreateClawPlayer (CreateClawPlayerReq) returns (CreateClawPlayerResp);
    rpc GetClawPlayerInfo (GetClawPlayerInfoReq) returns (GetClawPlayerInfoResp);
    rpc AdjustPlayerCoin (AdjustPlayerCoinReq) returns (AdjustPlayerCoinResp);
    rpc AdjustPlayerDiamond (AdjustPlayerDiamondReq) returns (AdjustPlayerDiamondResp);

    // machine 
    rpc CreateClawMachine (CreateClawMachineReq) returns (CreateClawMachineResp);
    rpc GetClawMachineInfo (GetClawMachineInfoReq) returns (GetClawMachineInfoResp);

    // game
    rpc StartClawGame (StartClawGameReq) returns (StartClawGameResp);

    // items
    rpc CreateClawItems (CreateClawItemsReq) returns (CreateClawItemsResp);
}